{"createdAt":"2025-06-06T10:51:03.215Z","updatedAt":"2025-06-06T10:52:10.297Z","id":"p572gcwmAmgGQaMp","name":"12 - LIMPEZA AUTOMÁTICA","active":false,"isArchived":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-280,120],"id":"8077110f-9c04-475d-b745-cfa68f63bb10","name":"Gatilho de Agendamento de Limpeza"},{"parameters":{"command":"sudo bash -lc 'command -v sqlite3 &>/dev/null || {    if command -v apt-get &>/dev/null; then      apt-get update -y && apt-get install -y sqlite3;    elif command -v yum &>/dev/null; then      yum install -y sqlite;    fi;  }'"},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[-60,120],"id":"c0ba8328-c950-4bae-9ea3-0ba9de0e31a4","name":"Instalar SQLite3 se Necessário","credentials":{"sshPassword":{"id":"704P5Oy4Ul61S643","name":"SSH Password account"}}},{"parameters":{"command":"sudo sqlite3 /etc/easypanel/projects/n8n/n8n/volumes/data/database.sqlite <<'EOF'\n-- mantém apenas as 1000 últimas execuções em execution_entity\nDELETE FROM execution_entity\nWHERE id NOT IN (\n  SELECT id FROM execution_entity\n  ORDER BY id DESC\n  LIMIT 1000\n);\n-- mantém apenas as 1000 últimas execuções em execution_data\nDELETE FROM execution_data\nWHERE executionId NOT IN (\n  SELECT executionId FROM execution_data\n  ORDER BY executionId DESC\n  LIMIT 1000\n);\nVACUUM;\nEOF\n"},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[160,120],"id":"8d1dedc2-c6f8-4756-b95e-840e1045c5b5","name":" Remover Execuções Antigas","credentials":{"sshPassword":{"id":"704P5Oy4Ul61S643","name":"SSH Password account"}}},{"parameters":{"command":"bash -lc \"echo 'SELECT COUNT(*) FROM execution_data;' | sqlite3 /etc/easypanel/projects/n8n/n8n/volumes/data/database.sqlite\""},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[380,120],"id":"d43d9f36-1bec-4f96-9b00-8512bd80ba31","name":"Contar Registros de Execução","credentials":{"sshPassword":{"id":"704P5Oy4Ul61S643","name":"SSH Password account"}}},{"parameters":{"command":"sudo rm -rf /tmp/*"},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[600,120],"id":"3498d77f-6b29-4814-a6a1-5613dfa51f7e","name":"Remover Arquivos Temporários","credentials":{"sshPassword":{"id":"704P5Oy4Ul61S643","name":"SSH Password account"}}}],"connections":{"Gatilho de Agendamento de Limpeza":{"main":[[{"node":"Instalar SQLite3 se Necessário","type":"main","index":0}]]},"Instalar SQLite3 se Necessário":{"main":[[{"node":" Remover Execuções Antigas","type":"main","index":0}]]}," Remover Execuções Antigas":{"main":[[{"node":"Contar Registros de Execução","type":"main","index":0}]]},"Contar Registros de Execução":{"main":[[{"node":"Remover Arquivos Temporários","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"887374bb-24f7-465d-bec5-adc4ba1541ca","triggerCount":0,"tags":[]}